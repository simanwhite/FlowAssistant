<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>work_process-JIRA308</title>
        <link type="text/css" rel="stylesheet" href="appbase.css">
    </head>
    <body class="wikidpad">
<span class="wikidpad parent-nodes">parent nodes: <span class="wikidpad parent-node"><a href="calendar_Nov_2016.html" class="wikidpad">calendar_Nov_2016</a></span> | <span class="wikidpad parent-node"><a href="calendar_Oct_2016.html" class="wikidpad">calendar_Oct_2016</a></span> | <span class="wikidpad parent-node"><a href="calendar_Sept_2016.html" class="wikidpad">calendar_Sept_2016</a></span> | <span class="wikidpad parent-node"><a href="work%20projects.html" class="wikidpad">work projects</a></span><br class="wikidpad" /><br class="wikidpad" /></span>
<a name=".h0" class="wikidpad"></a><h2 class="wikidpad heading-level2">work_process-JIRA308</h2>
<hr class="wikidpad" />
标题: [ssp] unexpected supply-port in tb.upf<br class="wikidpad" />
JIRA地址: <span class="wikidpad url-link"><a href="http://ontrack-internal.amd.com/browse/DMVMTVRF-308" class="wikidpad">http://ontrack-internal.amd.com/browse/DMVMTVRF-308</a></span><br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<a name=".h212" class="wikidpad"></a><h3 class="wikidpad heading-level3">状态及下一步(newest on top)</h3>
<hr class="wikidpad" />
<ol class="wikidpad orderedlist">
<li class="wikidpad" /><br class="wikidpad" />
<br class="wikidpad" />
</ol>
<a name=".h325" class="wikidpad"></a><h3 class="wikidpad heading-level3">环境及问题描述</h3>
<hr class="wikidpad" />
<b class="wikidpad">环境</b>:<br class="wikidpad" />
vnc: <br class="wikidpad" />
srdcws279:8<br class="wikidpad" />
123456<br class="wikidpad" />
<br class="wikidpad" />
/local_vol1_nobackup/zfyang/nbif2_0/ws0/out/linux_2.6.18_64.VCS/nbif_ssp_ntb/con<br class="wikidpad" />
fig/nbif_all_rtl/pub/sim<br class="wikidpad" />
<br class="wikidpad" />
/proj/verif_release_ro/powerflow_pkg/38.2.2.rc2<br class="wikidpad" />
<br class="wikidpad" />
nbif2_0/nbif2_0_main@2483545<br class="wikidpad" />
<br class="wikidpad" />
dj -c -DGENERATE_GLOBAL_FEATURES -DUSE_GPU_FEATURES -DPUBLISH_DEPERL_VPP 
-DUSE_FDL -DRELAX_FEATURE_ACCESS_CKS -l demo_test_1.log -DDEBUG 
-DUVM_VERBOSITY=UVM_HIGH -m4 -DUSE_VRQ -DSEED=12345678 run_test -s nbiftdl 
demo_test_1_nbif_all_rtl<br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<b class="wikidpad">问题描述</b>:<br class="wikidpad" />
据说加了<span class="wikidpad wiki-link"><a href="work_process-JIRA238.html" class="wikidpad">work_process-JIRA238</a></span>的修改以后, 别的project出现了问题. <br class="wikidpad" />
当时是加了nongfx的判断. 看来还要再考虑一下. <br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<a name=".h971" class="wikidpad"></a><h3 class="wikidpad heading-level3">日志(oldest on top)</h3>
<hr class="wikidpad" />
<a name=".h1074" class="wikidpad"></a><h4 class="wikidpad heading-level4">2016-9-23</h4>
为毛背景是黑的... 瞎了<br class="wikidpad" />
<br class="wikidpad" />
<b class="wikidpad">$分析$</b>:<br class="wikidpad" />
238当时修改了两个文件,<ol class="wikidpad orderedlist">
<li class="wikidpad" />power.tmpl加入了nongfx这个变量
<li class="wikidpad" />upf.tmpl里面用nongfx这个变量做了判断</ol>
确实跟本JIRA中提到的VDDGFX_CGPG有关系.<br class="wikidpad" />
<br class="wikidpad" />
原因是这样的:<br class="wikidpad" />
power.tmpl中没有匹配到-d NONGFX这个option, <br class="wikidpad" />
这是因为<ul class="wikidpad normalindent">if ($found_in_param &amp;&amp; exists($pg_inst_params{$str})) {<ul class="wikidpad normalindent">$pg_inst{$blkName}{$blkPath}{'option'} = $pg_inst_params{$str};<br class="wikidpad" />
if ($pg_inst_params{$str} =~ /-d NONGFX/) {<ul class="wikidpad normalindent">$nongfx = 1;</ul>
}</ul>
}</ul>
中, found_in_param是false的. <br class="wikidpad" />
而这又是因为<br class="wikidpad" />
PG_INST_PARAM  = nbif_shub_wrap_ntb__nbif_shub_wrap__pgfsm nbif_shub_wrap_ntb__nbif_shub_wrap__option<br class="wikidpad" />
做各种匹配时, 没有成功, 匹配代码如下:<ul class="wikidpad normalindent">foreach my $i (keys %pg_inst_params) {<ul class="wikidpad normalindent">if ($i =~ /${blkName}<i class="wikidpad"></i>(.*)__option/) {<ul class="wikidpad normalindent">my $j = $1;<br class="wikidpad" />
$j =~ s#<i class="wikidpad"></i>#$HIER_SEPARATOR#g;<br class="wikidpad" />
#print "XXXX $i, $blkName, $blkPath, $j, str is $str ," . $pg_inst_params{$str} . "n";<br class="wikidpad" />
if ($blkPath =~ /b$jb/) {<ul class="wikidpad normalindent">$found_in_param = 1;<br class="wikidpad" />
$str = $i;<br class="wikidpad" />
last;</ul>
}</ul>
}</ul>
}</ul>
$j是nbif_shub_wrap, $blkPath和${blkName}都是nbif_shub_wrap_ntb, 所以<ul class="wikidpad normalindent">if ($blkPath =~ /b$jb/)</ul>
匹配不到.<br class="wikidpad" />
为啥要这么匹配? b是匹配单词开头或结尾的非字母数字下划线字符. <br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<a name=".h2058" class="wikidpad"></a><h4 class="wikidpad heading-level4">2016-9-27</h4>
问题: IP环境下, top层的-d NONGFX option是取不到的, 只能从它下面的blk里面取.<br class="wikidpad" />
需要研究下IP环境时生成各层upf的先后顺序. <br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<a name=".h2154" class="wikidpad"></a><h4 class="wikidpad heading-level4">2016-9-28</h4>
后续问题: 将PG_TOP设成nbif_shub_wrap之后, 不生成tb.upf.2.0了, nbif_shub_wrap_ntb<br class="wikidpad" />
.upf.2.0中不再出现VDDGFX的东西了. 但是assert_dis.vh没有被生成. <br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<a name=".h2287" class="wikidpad"></a><h4 class="wikidpad heading-level4">2016-9-29</h4>
assert_dis.vh没有生成的问题分析:<br class="wikidpad" />
因为把PG_TOP设置成DUT层以后, power.tmpl发现PG_TOP出现在pg_inst中, 会将tileview<br class="wikidpad" />
设置成1, 以为是遇到了SoC环境. tileview=1时assert_dis.vh理论上是由chip.upf.tmpl<br class="wikidpad" />
负责生成的, 但是这里其实是IP环境, power.tmpl不是通过chip.upf.tmpl调用的. 所以, <br class="wikidpad" />
结论是, 目前脚本并不支持这样的情况. (即PG_TOP设成DUT层)<br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<a name=".h2545" class="wikidpad"></a><h4 class="wikidpad heading-level4">2016-10-7</h4>
Angela建议应该加分支, 引入另一个控制逻辑, 叫USE_TILE_UPF. 但是好像power.tmpl<br class="wikidpad" />
里还不能访问这个量. <br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
<br class="wikidpad" />
[tags: <br class="wikidpad" />
    </body>
</html>
